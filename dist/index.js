!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("whatwg-fetch")):"function"==typeof define&&define.amd?define(["whatwg-fetch"],e):t._fetch=e()}(this,function(){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c={headers:new Headers({"Content-Type":"application/json"}),mode:"same-origin",credentials:"include",cache:"reload",redirect:"follow",referrer:"client",timeout:3e4},u=function(t){return t.json().catch(function(t){throw new Error("JSON Parse Error: "+t)})},t=function(t){if(200<=t.status&&t.status<300||304==t.status)return t;throw new Error(t.statusText)},f=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("[object Object]"!==Object.prototype.toString.call(e)||0===Object.keys(e).length)return t;var n=[];for(var r in e)n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t+(-1===t.indexOf("?")?"?":"")+n.join("&")},h=function(t){return"function"==typeof c.fetchSuccess&&c.fetchSuccess(t),t},a=function(t){throw"function"==typeof c.fetchError&&c.fetchError(t),t=t instanceof Error?t:new Error(t)},s=function(o,i){return new Promise(function(e,n){var r,t=new Request(o,i);r=setTimeout(function(){var t=new Error(o+" timeout");t.fetchOption=i,n(t)},i.timeout),"function"==typeof i.fetchStart&&i.fetchStart(),fetch(t).then(function(t){clearTimeout(r),t.fetchOption=i,e(t)},function(t){clearTimeout(r),t.url=o,t.fetchOption=i,n(t)})}).then(t)};return{setOptions:function(t){c=i({},c,t)},getJSONP:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r="jsonp"+ +new Date,o=document.createElement("script");e[n.callbackName||"_callback"]=r;var i=f(t,e),c=document.head||document.querySelector("head")||document.documentElement;return o.setAttribute("src",i),o.setAttribute("charset","utf-8"),o.setAttribute("defer",!0),o.setAttribute("async",!0),c.insertBefore(o,c.firstChild),new Promise(function(e,t){window[r]=function(t){e(t),c.removeChild(o)},o.onerror=function(){t(),c.removeChild(o)}})},getJSON:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=i({},c,{method:"GET"},n),o=f(t,e);return s(o,r).then(u).then(h,a)},postJSON:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=i({},c,{method:"POST",body:JSON.stringify(e)},n);return s(t,r).then(u).then(h,a)},putJSON:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=i({},c,{method:"PUT",body:JSON.stringify(e)},n);return s(t,r).then(u).then(h,a)},deleteJSON:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=i({},c,{method:"DELETE"},n),o=f(t,e);return s(o,r).then(u).then(h,a)}}});
